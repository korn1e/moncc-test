version: 2.1
jobs:
  deploy:
    docker:
      - image: gcr.io/moncc-public-gcr/moncc-ci:latest
    steps: 
      - checkout
      - run:
          command: |
            MNCC="mncc -s /var/run/monccd.sock --nofancy --nocolor"
            sleep 10
            $MNCC login --email aji_perdana@yahoo.com --password Rahasia0~123
            sleep 10
            $MNCC cluster switch -m H4sIAAAAAAAA/6zRwUvDMBTH8X9IX/LSR9scB8OJ1dHoiosHoctcTUcl7dKJkj9ePCgiHlzb2zt9+D5+qlFVtrmmThf6YNZ+vs/ryxh3b69xeVNI25X3Tdrq6Hl+5ZqHgG2hs6CYr4+aPYY4MCfcubGd6a3/vNlp4BmzjhiKBDhwQOaNY0Sc43BLCsA4BQSSU3Dfaf32y2p7a6bpm8rkgCIFDiL6m9xU7/7isPK9TStVLtxsN3s6ZvuX7W29VpIak/vlXb5a4DLL//X3APBH4+9ZxuSNtyKCRABJwESM4j4CAAD//z7EpRdMAwAA
            sleep 60
            $MNCC load postgres.yaml
            sleep 10
            $MNCC cluster peers
            $MNCC run -t pg postgres/latest
            sleep 10
            $MNCC update postgres/latest
workflows:
  build:
    jobs:
      - deploy
